name: Selenium Grid Test

on:
  push:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        os: [macos-latest, windows-latest]
        browser: [chrome, firefox]
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
      
    - name: Setup JDK
      uses: actions/setup-java@v2
      with:
        java-version: '11'
    
    - name: Start Selenium Grid
      uses: santiycr/selenium-grid-gh-actions@v1.1.1
      with:
        browsers: ${{ matrix.browser }}
        max-sessions: 2
    
    - name: Run Selenium Tests
      run: mvn test -DremoteDriverUrl=http://localhost:4444/wd/hub -Dos=${{ matrix.os }} -Dbrowser=${{ matrix.browser }} -DsuiteXmlFile=web_testng.xml
